(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{"7b93":function(t,e,i){"use strict";var o=i("fc9c"),s=i.n(o);s.a},9365:function(t,e,i){"use strict";i.r(e);var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{"background-color":"black"}},[i("q-btn",{staticClass:"fixed-top-right",staticStyle:{"z-index":"99"},attrs:{flat:"",round:"","text-color":"secondary",icon:t.$q.fullscreen.isActive?"mdi-fullscreen-exit":"mdi-fullscreen"},on:{click:t.doFullScreen}}),t.mod&&t.modHelperList[t.mod]&&t.mod.length>0?i("div",{staticClass:"fixed-bottom",staticStyle:{"z-index":"99"}},[i("div",{staticClass:"text-center"},[i("q-badge",{attrs:{color:t.modHelperList[t.mod].color}},[t._v("\n        "+t._s(t.modHelperList[t.mod].text)+" mod ON\n      ")])],1)]):t._e(),i("div",{attrs:{id:"gameContainer"},on:{contextmenu:function(t){t.preventDefault()}}}),i("upper-hidden-board",{directives:[{name:"show",rawName:"v-show",value:t.isUpperHiddenBoardDisplay,expression:"isUpperHiddenBoardDisplay"}],attrs:{src:t.src}})],1)},s=[],n=i("c973"),d=i.n(n),r=i("54f2"),a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"touch-pan",rawName:"v-touch-pan.prevent.mouse",value:t.handlePan,expression:"handlePan",modifiers:{prevent:!0,mouse:!0}}],ref:"board",staticClass:"flex-center",staticStyle:{display:"none",position:"fixed",margin:"auto",left:"0",right:"0","background-color":"black",width:"500px",height:"100px"}},[i("div",{staticClass:"text-center"},[i("q-btn",{attrs:{flat:"",round:"","text-color":"primary",icon:t.visible?"visibility_off":"visibility"},on:{click:function(e){t.visible=!t.visible}}})],1)])},c=[],l=(i("5319"),i("4082")),h=i.n(l),u={name:"UpperHiddenBoard",props:{src:{type:String,default:""}},data:function(){return{boardWidth:.8*document.body.clientWidth,boardHeight:.05*document.body.clientHeight,direction:"",startPos:[0,0],visible:!0,backgroundImage:""}},watch:{visible(t){let e=this.$refs.board;t?(e.style.width=this.boardWidth+"px",e.style.height=this.boardHeight+"px",e.style.background="black",this.backgroundImage=this.src,e.style.backgroundSize="cover",e.style["margin-top"]="0px"):(e.style.width="42px",e.style.height="42px",e.style.background="rgba(0, 0, 0, 0)",this.backgroundImage="",e.style["margin-top"]="-16px")},src(t){this.backgroundImage=t},backgroundImage(t){let e=this.$refs.board;e.style.backgroundImage=t}},methods:{handlePan(t){let{evt:e}=t,i=h()(t,["evt"]);if(this.visible){let t=this.$refs.board;i.isFirst&&(this.boardWidth=Number(t.style.width.replace(/\s+|px/gi,"")),this.boardHeight=Number(t.style.height.replace(/\s+|px/gi,"")),this.direction=i.direction),"up"!==this.direction&&"down"!==this.direction||(t.style.height=this.boardHeight+i.offset.y+"px"),"left"!==this.direction&&"right"!==this.direction||(t.style.width=this.boardWidth+i.offset.x+"px"),this.boardHeight+i.offset.y<=.1*document.documentElement.clientHeight&&(t.style.height=.1*document.documentElement.clientHeight+"px"),this.boardWidth+i.offset.x<=.1*document.documentElement.clientWidth&&(t.style.width=.1*document.documentElement.clientWidth+"px"),this.boardHeight+i.offset.y>document.documentElement.clientHeight&&(t.style.height=document.documentElement.clientHeight+"px"),this.boardWidth+i.offset.x>document.documentElement.clientWidth&&(t.style.width=document.documentElement.clientWidth+"px"),this.boardHeight+i.offset.y<50&&(t.style.height="50px"),this.boardWidth+i.offset.x<50&&(t.style.width="50px"),i.isFinal&&(this.boardWidth=Number(t.style.width.replace(/\s+|px/gi,"")),this.boardHeight=Number(t.style.height.replace(/\s+|px/gi,"")),this.$q.localStorage.set("upperHiddenBoard",[this.boardWidth,this.boardHeight]))}}},mounted(){let t=this.$refs.board,e=this.$q.localStorage.getItem("upperHiddenBoard");e||(e=[500,100]),this.boardWidth=e[0],this.boardHeight=e[1],t.style.width=this.boardWidth+"px",t.style.height=this.boardHeight+"px",this.backgroundImage=""+this.src,t.style.backgroundImage=this.backgroundImage,console.log(t.style.backgroundImage),t.style.backgroundSize="cover"}},m=u,p=i("2877"),g=i("9c40"),b=i("75c3"),f=i("eebe"),y=i.n(f),v=Object(p["a"])(m,a,c,!1,null,"961c3302",null),x=v.exports;y()(v,"components",{QBtn:g["a"]}),y()(v,"directives",{TouchPan:b["a"]});var H=i("f303");const{height:$,width:w}=H["c"];var k={name:"Game",components:{UpperHiddenBoard:x},data:function(){return{isUpperHiddenBoardDisplay:!1,src:""}},computed:{mod:{get(){return this.$store.state.mods.mod}},modHelperList:{get(){return this.$store.state.mods.modHelperList}}},methods:{doFullScreen(){try{this.$q.fullscreen.toggle()}catch(t){}}},mounted(){var t=this;return d()((function*(){t.$audio.pause(),t.$audio.setDisable(!0);let e,i,o=null;try{e=t.$store.getters["settings/settings"],i=e.gameConfig,o=t.$store.state.chartInfo.gameLoadConfig}catch(a){return void(yield t.$router.push("/"))}if(!i||!o)return void(yield t.$router.push("/"));try{document.addEventListener("touchstart",(function(t){t.touches.length>1&&t.preventDefault()}));let t=0;document.addEventListener("touchend",(function(e){var i=(new Date).getTime();i-t<=300&&e.preventDefault(),t=i}),!1),document.addEventListener("gesturestart",(function(t){t.preventDefault()}))}catch(c){}let s=document.getElementById("gameContainer"),n=document.createElement("canvas");n.id="game",n.style.height="100%",n.style.width="100%",s.appendChild(n);try{e.autoFullscreen&&!t.$q.fullscreen.isActive&&(yield t.$q.fullscreen.toggle())}catch(l){}t.isUpperHiddenBoardDisplay=e.upperHidden,t.isUpperHiddenBoardDisplay&&(t.src=`url(${e.upperHiddenImg})`),document.documentElement.clientHeight>document.documentElement.clientWidth&&t.$q.notify({message:t.$t("public.tip"),caption:t.$t("TIP_NOT_HORIZONTAL"),icon:"info"});let d=null;try{d=new r["Game"](n,i,o),d.start(),d.ondestroyed=()=>{s.removeChild(n),t.$router.push("/")}}catch(h){yield t.$router.push("/")}}))()},beforeDestroy(){this.$audio.setDisable(!1),this.$audio.setDefaultAudio(),this.$audio.play()}},E=k,W=(i("7b93"),i("58a8")),I=Object(p["a"])(E,o,s,!1,null,"d13c3d0e",null);e["default"]=I.exports;y()(I,"components",{QBtn:g["a"],QBadge:W["a"]})},fc9c:function(t,e,i){}}]);